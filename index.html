<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clean Time</title>
    <style>
        :root {
            --primary: #262626;
            --secondary: #707070;
            --background: #f5f5f5;
            --card-bg: #ffffff;
            --spacing: 1.5rem;
            --spacing-small: 0.75rem;
            --border-radius: 0.75rem;
            --box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            text-align: center;
            background-color: var(--background);
            color: var(--primary);
            padding: var(--spacing);
            line-height: 1.5;
        }

        .card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: var(--spacing);
            width: 100%;
            max-width: 22rem;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .timer {
            font-size: 1rem;
            font-weight: 400;
            margin-bottom: var(--spacing-small);
            color: var(--primary);
            overflow-wrap: break-word;
        }

        .timer span {
            display: block;
            font-size: 1.5rem;
            font-weight: 300;
            letter-spacing: -0.5px;
            margin-top: 0.25rem;
            white-space: nowrap;
        }

        .button {
            appearance: none;
            border: 1px solid var(--primary);
            background: transparent;
            padding: 0.75rem 1.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--primary);
            width: auto;
            max-width: 100%;
            margin: var(--spacing-small) 0;
            border-radius: 5px;
            white-space: nowrap;
        }

        .button:hover {
            background: var(--primary);
            color: var(--card-bg);
        }

        .timestamp {
            font-size: 0.75rem;
            color: var(--secondary);
            margin-top: var(--spacing-small);
            white-space: nowrap;
            overflow-wrap: break-word;
        }

        @media (min-width: 640px) {
            .card {
                max-width: 28rem;
                padding: calc(var(--spacing) * 1.25);
            }
            .timer span {
                font-size: 2rem;
            }
            .button {
                padding: 1rem 1.75rem;
                font-size: 1rem;
            }
            .timestamp {
                font-size: 0.875rem;
            }
        }

        @media (min-width: 1024px) {
            .card {
                max-width: 36rem;
                padding: calc(var(--spacing) * 1.5);
            }
            .timer {
                font-size: 1.25rem;
            }
            .button {
                padding: 1.25rem 2.25rem;
                font-size: 1.125rem;
            }
            .timestamp {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="card">
        <div class="timer" id="timer">
            You have been clean for
            <span id="timerSpan">0 years, 0 months, 0 days, 0 hours, 0 minutes, and 0 seconds</span>
        </div>
        <button id="pledgeButton" class="button">I pledge to stay clean till I die</button>
        <div id="timestamp" class="timestamp"></div>
    </div>

    <script>
        const timerElement = document.getElementById('timerSpan');
        const buttonElement = document.getElementById('pledgeButton');
        const timestampElement = document.getElementById('timestamp');

        let startTime = localStorage.getItem('startTime') ? new Date(localStorage.getItem('startTime')) : null;
        let intervalId = null;

        function updateTimer() {
            const diff = new Date() - startTime;
            const seconds = Math.floor(diff / 1000) % 60;
            const minutes = Math.floor(diff / 60000) % 60;
            const hours = Math.floor(diff / 3600000) % 24;
            const days = Math.floor(diff / 86400000) % 30;
            const months = Math.floor(diff / (86400000 * 30)) % 12;
            const years = Math.floor(diff / (86400000 * 365));

            const parts = [
                years && `${years} year${years !== 1 ? 's' : ''}`,
                months && `${months} month${months !== 1 ? 's' : ''}`,
                days && `${days} day${days !== 1 ? 's' : ''}`,
                hours && `${hours} hour${hours !== 1 ? 's' : ''}`,
                minutes && `${minutes} minute${minutes !== 1 ? 's' : ''}`,
                seconds && `${seconds} second${seconds !== 1 ? 's' : ''}`
            ].filter(Boolean);

            timerElement.textContent = parts.join(', ');
        }

        function updateTimestamp(text) {
            timestampElement.innerHTML = `${text}<br>${startTime.toLocaleString('en-IN', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric', hour12: true })}`;
        }

        function startTimer() {
            updateTimer(); // Initial update to avoid default state
            intervalId = setInterval(updateTimer, 1000);
        }

        if (startTime) {
            updateTimestamp('You took the pledge on');
            buttonElement.innerText = 'I broke my pledge, start again';
            startTimer();
        }

        buttonElement.addEventListener('click', () => {
            clearInterval(intervalId);
            startTime = new Date();
            localStorage.setItem('startTime', startTime);
            updateTimestamp('You took the pledge on');
            buttonElement.innerText = 'I broke my pledge, start again';
            startTimer();
        });
    </script>
</body>
</html>
